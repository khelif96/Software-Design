function postForm(t,e,i,o){i=i||"post",o=o||"_self";var s=document.createElement("form");s.setAttribute("method",i),s.setAttribute("action",t),s.setAttribute("target",o);for(var n in e)if(e.hasOwnProperty(n)){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",n),r.setAttribute("value",e[n]),s.appendChild(r)}document.body.appendChild(s),s.submit()}Eggshell.define("C.common.csrestartmodal",{inputs:["render","show"],outputs:["primary_cta_clicked","restart_success"]},function(){var t=Backbone.Model.extend({restartSubscription:function(t){$.ajax({type:"post",dataType:"json",url:"/_ajax/hwh/undocancel",data:{token:C.global.csrfToken,apiData:{subId:t,uuid:C.global.userUuid}},context:this,success:function(t){this.triggerSuccess()}})},triggerSuccess:function(){this.trigger("restart_success")}}),e=Backbone.View.extend({initialize:function(e){this.data=$.extend({},e),this.model=new t,this.model.on("restart_success",this.triggerRestartSuccess,this),Eggshell.find(this).on("render",this.render,this).on("show",this.show,this)},render:function(){this.popupRestart?this.popupRestart.trigger("show"):this.popupRestart=Eggshell.create("C.common.dialog").trigger("set headline","Welcome back").trigger("set content html",this.restartModalTemplate(this.data.subscription)).trigger("set id","uncancel-modal").trigger("enable default control").trigger("set primary button","Restart membership").trigger("set secondary button","Go back").on("primary button clicked",this.onCtaClick,this).on("secondary button clicked",this.hide,this)},show:function(){this.popupRestart&&this.popupRestart.trigger("show")},hide:function(){this.popupRestart&&this.popupRestart.trigger("hide")},onCtaClick:function(){this.triggerCtaClick(),this.model.restartSubscription(this.data.subscription.subscription.id)},triggerCtaClick:function(){Eggshell.find(this).trigger("primary_cta_clicked")},triggerRestartSuccess:function(){Eggshell.find(this).trigger("restart_success")},restartModalTemplate:_.template('<div class="resume-dialog"><% if(subscription.suspended) {%>Welcome back. It\'s only $<%- subscription.price %> per <%- (subscription.renewalPeriod === "yr") ? "year" : "month" %> to resume your Chegg Study membership. <% if (billing.paypal) { %><strong><%- billing.paypal %></strong><% } else { %>Your <%- billing.type %> ending in <strong><%- billing.last4 %></strong><% } %> will be charged today.<% } else { %><% if (subscription.subscriptionState.isCancelPending) { %>Your subscription will no longer be cancelled on <%- subscription.renewalDate %>. It will auto-renew and <% } else { %>Your subscription will no longer be paused on <%- subscription.suspendDate %>. It will auto-renew and <% } %><% if (billing.paypal) { %><strong><%- billing.paypal %></strong><% } else { %>your <%- billing.type %> ending in <strong><%- billing.last4 %></strong><% } %> will be charged $<%- subscription.price %> at that time.<% } %> </div> ')});return e}()),Eggshell.define("C.common.twilio",{inputs:["render twilio inline","render twilio field","set placeholder text","send text","listen for enter submit","set submit listener","set send text data","set input size","set auto focus"],outputs:["send text success","send text failure","input submitted"]},function(){var t=Backbone.View.extend({initialize:function(t){this.placeholderText="888-888-8888",this.sendTextData=null,this.inputSize="sm",this.autofocus_enabled=!0,Eggshell.find(this).on("render twilio inline",this.renderTwilioInline,this).on("render twilio field",this.renderTwilioField,this).on("set placeholder text",this.setPlaceholderText,this).on("set send text data",this.setSendTextData,this).on("set input size",this.setInputSize,this).on("listen for enter submit",this.setupEnterListener,this).on("set submit listener",this.setupSubmitListener,this).on("send text",this.sendText,this).on("set auto focus",this.setAutoFocus,this)},renderTwilioInline:function(t,e){this.$el.html('<div class="mobile-location-checkout"><div class="mobile-number-label">Mobile number (optional)</div><div class="mobile-number-container"><input maxlength="12" name="mobile_num" type="text" placeholder="'+this.placeholderText+'" value="" /></div><div class="mobile-number-desc"><div class="mobile-number-header">Get the Chegg mobile app texted to you</div><div class="mobile-number-details">Message and data rates may apply. Message may be sent using an automatic telephone dialing system. Consent not required to purchase goods or services. For help, reply HELP to any text. Read <a href="/mobiledisclosures" target="_blank">Chegg\'s Mobile Disclosures</a>.</div></div></div>'),$(e.container).append(this.$el)},twilioInlineTmpl:_.template('<div class="mobile-location-postcheckout"><div class="mobile-number-container"><input class="form-input-<%- inputSize %>" maxlength="12" name="mobile_num" type="text" placeholder="<%- placeholderText %>" value="" <%- autofocus %>/></div></div>'),renderTwilioField:function(t,e){var i=this.autofocus_enabled?"autofocus":"";this.$el.html(this.twilioInlineTmpl({inputSize:this.inputSize,placeholderText:this.placeholderText,autofocus:i})),$(e.container).append(this.$el)},setPlaceholderText:function(t,e){if(!e||"string"!=typeof e)throw"Invalid placeholder text!";this.placeholderText=e},onMobileNumberKeyUp:function(t){var e=$(t.currentTarget),i=e.val();i=i.replace(/\D/g,""),i=i.replace(/(\d{3})(\d{1,3})(\d*)/,"$1-$2-$3"),i=i.replace(/\-$/,""),e.val(i)},setupEnterListener:function(t,e){$("input[name=mobile_num]").on("keydown",$.proxy(function(t){13===t.keyCode&&this.sendText()},this))},setupSubmitListener:function(t,e){if(!e||"string"!=typeof e)throw"Invalid submit class name for twilio";$("."+e).on("click",$.proxy(function(t){t.preventDefault(),this.sendText()},this))},setSendTextData:function(t,e){this.sendTextData=e},setInputSize:function(t,e){("sm"===e||"lg"===e)&&(this.inputSize=e)},sendText:function(t){this.Eggshell.trigger("input submitted");var e=$("input[name=mobile_num]").val(),i=this.sendTextData?$.extend(this.sendTextData,{token:C.global.csrfToken,phoneNum:e}):null;i.phoneNum&&/\d{3}-\d{3}-\d{4}/.test(i.phoneNum)?$.ajax({url:"/_ajax/hwh/twilio/",type:"POST",data:i,context:this,success:function(t){this.Eggshell.trigger("send text success")},error:function(t){this.Eggshell.trigger("send text failure"),this.showSendTextFailureMsg("Error sending message. Please try again.")}}):(this.Eggshell.trigger("send text failure"),this.showSendTextFailureMsg("Please enter a valid phone number."))},setAutoFocus:function(t,e){this.autofocus_enabled=e.enabled},showSendTextFailureMsg:function(t){$(".twilio-error-msg").remove(),this.$el.append('<div class="twilio-error-msg">'+t+"</div>")},events:{"keyup [name=mobile_num]":"onMobileNumberKeyUp"}});return t}()),Eggshell.define("C.cs.apppromomodal",{inputs:["render"],outputs:[],strict:!1},function(){var t=Backbone.View.extend({initialize:function(t){this.opts=$.extend(t,{}),this.Eggshell.on("render",this.render,this)},render:function(){this.dialog=Eggshell.create("C.common.dialog").trigger("hide control").trigger("hide close button").trigger("disable screen blocker click").trigger("set content html",this.modalTemplate());var t=this.dialog.getId().replace(".","-");$("#"+t).addClass("apppromomodal-dialog"),this.renderTwilio(),$(".apppromomodal-skip-link").on("click",$.proxy(function(t){this.storeModalViewKvp()},this))},renderTwilio:function(){this.twilioComponent=Eggshell.create("C.common.twilio").trigger("render twilio field",{container:".apppromomodal-twilio-input"}).trigger("set send text data",{type:"study_adjust"}).trigger("listen for enter submit").trigger("set submit listener","apppromomodal-send-btn"),Eggshell.find(this.twilioComponent).on("input submitted",function(){$(".apppromomodal-send-btn").attr("disabled","disabled")}),Eggshell.find(this.twilioComponent).on("send text failure",$.proxy(function(){$(".apppromomodal-send-btn").attr("disabled",!1)},this)),Eggshell.find(this.twilioComponent).on("send text success",$.proxy(function(){this.storeModalViewKvp()},this))},modalTemplate:_.template('<div class="apppromomodal"><div class="apppromomodal-app-stars"><span class="appromomodal-star-icons"></span>4,000+ five star reviews. | Available on iOS and Android</div><div class="apppromomodal-header">Take Chegg Study with you on-the-go</div><div class="apppromomodal-content"><div class="apppromomodal-image"></div><div class="apppromomodal-valueprop"><div class="apppromomodal-subheader">We\'ll send you a one time download link</div><div class="apppromomodal-proofpoints"><ul class="chg-list"><li><span>Take your textbook solutions on-the-go</span></li><li><span>Ask questions anywhere with your phone camera</span></li><li><span>Get notified right away when your questions are answered</span></li></div></div><div class="apppromomodal-twilio-input"></div><div class="apppromomodal-actions"><button class="apppromomodal-send-btn btn-primary-sm">Text me</button><div class="apppromomodal-skip-link"><a href="#">No thanks</a></div></div><div class="apppromomodal-disclaimer">Your number won\'t be shared or stored. <a href="/mobiledisclosures">Chegg\'s Mobile Disclosures.</a><div></div></div>'),storeModalViewKvp:function(){$.ajax({url:"/_ajax/common/userkvp/set",type:"GET",data:{token:C.global.csrfToken,key:"showAppPromoModal",value:!1},context:this,success:function(t){Eggshell.find(this.dialog).trigger("hide").trigger("destroy")},error:function(t){Eggshell.find(this.dialog).trigger("hide").trigger("destroy"),console.log("Error storing user kvp value "+JSON.stringify(t))}})}});return t}()),Eggshell.define("C.common.tutors",{inputs:["set opportunity modal data","show tutors","set_quick_chat_data","set entity id"],outputs:["error","ready"],singleton:!0},function(){var t=Backbone.Model.extend({getTutors:function(t){var e="undefined"!=typeof t.count?t.count:3,i="undefined"!=typeof t.noSubjectCheck?t.noSubjectCheck:0;$.ajax({context:this,type:"GET",dataType:"JSON",url:"/_ajax/tutors",data:{token:C.global.csrfToken,subjectId:t.subjectId,subjectName:t.subjectName,campaign:t.campaign,limit:e,noSubjectCheck:i},success:function(t){$.isEmptyObject(t)?this.trigger("errored"):(this.set("response",t),this.trigger("loaded"))},error:function(){this.trigger("errored")}})},getSessionVariable:function(t){$.ajax({url:"/_ajax/common/session/get",type:"get",dataType:"json",data:{key:t,token:C.global.csrfToken},context:this,success:function(e){this.set(t,e)},error:function(){this.set(t,{value:"0"})}})},setSessionVariable:function(t,e){$.ajax({url:"/_ajax/common/session/set",type:"get",dataType:"json",data:{key:t,value:e,token:C.global.csrfToken},context:this})},getAccessCode:function(t,e){$.ajax({url:"/_ajax/hwh/grantaccess",type:"get",dataType:"json",data:{assetId:t.assetId,assetType:t.assetType,offer:t.offer,userAgent:t.userAgent,token:C.global.csrfToken},context:this,complete:function(t){var i=$.parseJSON(t.responseText);i&&i.accessCode&&"string"==typeof i.accessCode?this.set("accessCode",i.accessCode):this.set("accessCode",null),this.trigger(e)}})}}),e=Backbone.View.extend({tutorTemplate:_.template('<div class="tutor-container <%= variant %> clearfix"><div class="tutor-headline"></div><div class="tutor-content"></div><div class="tutors-footer"></div></div>'),initialize:function(){this.model=new t,this.setUpListeners()},setUpListeners:function(){this.model.on("loaded",this.render,this),this.model.on("errored",this.renderError,this),this.model.on("do_tbs_opportunity_flow",this.doTbsOpportunityFlow,this),Eggshell.find(this).on("set opportunity modal data",this.setOpportunityModalData).on("show tutors",this.showTutors).on("set entity id",this.setEntityId).on("set_quick_chat_data",this.setupQuickChat)},setEntityId:function(t,e){this.entityId=e},setupQuickChat:function(t,e){this.$quickChatContainerElem=e.elem,this.quickChatExperience=e.experience,this.quickChatOcUrl=e.quickChatOcPath,this.doQuickChat="quickchat"==e.experience?!0:!1,this.doQuickChat&&this.insertQuickChatComponent()},setOpportunityModalData:function(t,e){this.modalContext=e.modalContext,this.modalBody=e.modalBody},showTutors:function(t,e){this.model.getTutors(e),this.source=e.type,this.product=e.product,this.variant=e.variant?e.variant:"",this.subject=e.subjectName,this.subjectId=e.subjectId,this.userHasCsSubscription=e.userHasCsSubscription,this.entityId=e.entityId},render:function(){var t=this.model.get("response"),e=this.tutorTemplate;this.$el.empty(),this.$el.html(e({variant:this.variant})),this.renderTutors(t)},renderTutors:function(t){var e=t.tutors,i=t.url,o=t.exception||null===this.model.get("subjectId")?"Top":this.subject,s='<span class="subject">'+o+"</span> Chegg tutors who can help right now",n='<a href="'+i+'" data-noajax><button class="tutors-cta btn-flat-sm">See more Chegg tutors</button></a>',r=0,a=$(".tutor-content");switch(this.source){case"rightrail":for(this.$(".tutor-headline").html(s),this.$(".tutors-footer").html(n),this.$(".tutors-cta").addClass("rightrail-cta"),r=0;r<e.length;r++)this.displayQnaTutors(e[r],a,"qna");t.exception&&$(".online-indicator ").addClass("hidden"),this.modalContext?($(".tutors-cta").text("Find me a tutor"),this.listenToOpportunityClick()):this.setupDefaultListeners();break;case"tbs":for(this.$(".tutor-headline").html(s),this.$(".tutors-footer").html(n),this.$(".tutors-footer").addClass("tbs-footer"),$(".tutor-container").css({padding:"20px"}),e.length%2==0&&e.splice(e.length-1,1),r=0;r<e.length-1;r+=2)this.displayleftTutor(e[r],a),this.displayRightTutor(e[r+1],a);e.length%2!==0&&this.displayleftTutor(e[r],a),this.modalContext?($(".tutors-cta").text("Find me a tutor"),this.listenToOpportunityClick()):this.setupDefaultListeners();break;case"cshp":for(s="Find an online tutor who can help with your toughest classes. Connect instantly or schedule a convenient time to meet.",r=0;r<e.length-1;r+=2)this.displayleftTutor(e[r],a),this.displayRightTutor(e[r+1],a);$(".tutor-container").addClass("cshp-container"),$(".tutor-card").addClass("cshp-card"),$(".tutor-headline").html(s),$(".tutors-footer").html(n),$(".tutors-cta").html("Find a tutor"),this.setupDefaultListeners()}Eggshell.find(this).trigger("ready")},listenToOpportunityClick:function(){$(".tutor-row, .tutors-cta").on("click",$.proxy(function(t){if(t.preventDefault(),t.stopPropagation(),$(t.currentTarget).hasClass("tutor-row")){var e={tutor_clicked:1};this.tutorsRedirectUrl=$(t.currentTarget).find("a").attr("href")}else{var e={tutors_button_clicked:1};this.tutorsRedirectUrl=$(t.currentTarget).parent().attr("href")}var i="TBS"==this.product?this.doTbsOpportunityClickBehavior(t):this.doGenericOpportunityFlow(t);C.logger.doSessionLog(e,i,{logSubscription:1})},this))},doTbsOpportunityClickBehavior:function(t){if(t.preventDefault(),t.stopPropagation(),this.userHasCsSubscription){var e=this.getGrantAccessData();this.model.getAccessCode(e,"do_tbs_opportunity_flow")}else this.doTbsOpportunityFlow()},doTbsOpportunityFlow:function(){var t=this.model.get("accessCode");"undefined"!=typeof t&&(this.modalBody+="?access_code="+t),this.setOpportunityModalCookie(),C.utility.navigate(this.tutorsRedirectUrl)},doGenericOpportunityFlow:function(t){if(this.doQuickChat){var e=$(t.currentTarget).find("a").data("id");this.openQuickChat(e)}else this.setOpportunityModalCookie(),C.utility.navigate(this.tutorsRedirectUrl)},setOpportunityModalCookie:function(){var t=this.model.get("response"),e=t&&t.instaEduSubjectId?t.instaEduSubjectId:this.subjectId,i=new Date,o=i.getTime();i.setTime(o+6e5);var s=i.toGMTString(),n=".chegg",r=window.location.host.split(n),a=n+r[1],l="control"==this.quickChatExperience?this.modalContext+"_CONTROL":this.modalContext,c='{"formData":{"body":"'+this.modalBody+'","modalContext":"'+l+'","subject":"'+this.subject+'","subjectID":"'+e+'","priority":1,"isBlast":true,"timestamp": '+o+"}}";document.cookie="messageData="+c+";domain="+a+";path=/; expires="+s},setupDefaultListeners:function(){$tutor=$(".tutor-content .C-common-tutors-tutor"),$tutorsCta=$(".tutors-cta"),$tutor.on("click",$.proxy(function(t){var e=$(t.currentTarget);t.preventDefault(),C.logger.doSessionLog({tutor_clicked:1},function(){location.href=e.find("a").attr("href")},{logSubscription:1})},this)),$tutorsCta.on("click",$.proxy(function(t){t.preventDefault(),C.logger.doSessionLog({tutors_button_clicked:1},function(){location.href=$tutorsCta.parent().attr("href")},{logSubscription:1})},this))},getGrantAccessData:function(){return{assetId:this.entityId,assetType:"TBS",offer:"TBS_SOLUTION_2H_ACCESS",userAgent:"WEB"}},insertQuickChatComponent:function(){this.$quickChatContainerElem.append('<oc-component href="'+this.quickChatOcUrl+'"></oc-component>'),oc.renderUnloadedComponents()},openQuickChat:function(t){var e=this.model.get("response"),i=e&&e.instaEduSubjectId?e.instaEduSubjectId:this.subjectId,o="QNA"==this.product?"QnA":this.product,s={subjectId:i,tutorId:t?t:null,asset:{type:o,id:this.entityId}};window.startQuickChat(s)},displayQnaTutors:function(t,e,i){var o=$('<div class="tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:o}).trigger("get "+i+" tutor",t),e.append(o)},displayleftTutor:function(t,e){var i=$('<div class="tutor-card left-card tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:i}).trigger("get tbs tutor",t),e.append(i)},displayRightTutor:function(t,e){var i=$('<div class="tutor-card right-card tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:i}).trigger("get tbs tutor",t),e.append(i)},renderError:function(){Eggshell.find(this).trigger("error")}});return e}()),Eggshell.define("C.common.tutors.tutor",{inputs:["get qna tutor","get tbs tutor","get mystuff tutor"],outputs:[]},Backbone.View.extend({tutorTemplate:_.template('<a href="<%= uri %>" data-noajax data-id=<%= id %>><div class="online-indicator <%= hidden %>"><div class="circle-icn"></div><div class="check-icn"></div></div><img class="tutor-img" src="<%= picture %>" onError="this.onerror=null;this.src=\'<%= default_picture %>\'"><div class="tutor-info"><div class="name"><%= name %></div><div class="school"><%= school %></div></div><div class="tutor-likes"><div class="thumbs-icn"><div class="reviews"><%= reviews %></div></div></div></a>'),initialize:function(){this.setUpListeners()},setUpListeners:function(){Eggshell.find(this).on("get qna tutor",this.renderQnaTutor,this).on("get tbs tutor",this.renderTbsTutor,this).on("get mystuff tutor",this.renderMyStuffTutor,this)},renderQnaTutor:function(t,e){var i=e.last_name.charAt(0)+".",o=e.first_name+" "+i;this.$el.html(this.tutorTemplate({uri:e.uri,hidden:"",picture:e.image_thumb_small,default_picture:e.default_images.image_thumb_small,name:o,school:e.school,reviews:e.positive_reviews,id:e.id})),e.available_now?this.$(".circle-icn").hide():this.$(".check-icn").hide()},renderTbsTutor:function(t,e){var i=e.last_name.charAt(0)+".",o=e.first_name+" "+i;this.$el.html(this.tutorTemplate({uri:e.uri,hidden:"hidden",picture:e.image_thumb_medium,default_picture:e.default_images.image_thumb_medium,name:o,school:e.school,reviews:e.positive_reviews,id:e.id}))},renderMyStuffTutor:function(t,e){var i=e.last_name.charAt(0)+".",o=e.first_name+" "+i;this.$el.html(this.tutorTemplate({uri:e.uri,hidden:"",picture:e.image_thumb_small,default_picture:e.default_images.image_thumb_small,name:o,school:e.school,reviews:e.positive_reviews,id:e.id})),this.$(".tutor-info").append(this.$(".tutor-likes")),this.$(".check-icn").hide(),e.available_now||3===e.chat_availability||this.$(".circle-icn").hide()}})),Eggshell.define("C.common.viewlimitmodal",{inputs:[],outputs:[]},C.View.extend({initialize:function(){this.model=new C.viewlimitmodal.model,this.model.on("couponDataRetrieved",this.createPopup,this)},viewLimitContent:{dialogId:"view-limit-dialog",primaryBtnText:"Create new account",headline:"UH-OH! WE'VE DETECTED MULTIPLE USERS."},limitMessageTemplate:_.template('<div class="limit-msg-wrapper"><div class="limit-msg">Our system detects multiple users on this account. You can continue to access your existing Textbook Solution books, but access to new books will be blocked for up to 30 days. If you are not the primary account holder, create a new account to immediately regain access. <a href="http://www.chegg.com/contactus/Returns/50994120">Contact us</a> if you have questions or think this is a mistake.</div></div><img class="avatar" src="<%= avatarPath %>">'),couponTemplate:_.template('<div class="coupon-wrapper"><div class="header">Get <%= couponSavings %> off your first month</div><input type="text" class="coupon-code" value="<%= couponCode %>" autofocus readonly /><div class="fineprint">Coupon valid for 7 days. Paste code at checkout.</div></div>'),createPopup:function(){this.popup=Eggshell.create("C.common.dialog");var t=this.limitMessageTemplate({avatarPath:C.global.assetUrl+"site/avatars/img-avatar-gry-60x60.png"})+this.couponTemplate({couponSavings:this.model.get("couponSavings"),couponCode:this.model.get("couponCode")});this.popup.trigger("hide sub headline").trigger("hide icon").trigger("enable default control").trigger("set primary button",this.viewLimitContent.primaryBtnText).trigger("set id",this.viewLimitContent.dialogId).trigger("set headline",this.viewLimitContent.headline).trigger("set content",t).trigger("hide close button").trigger("disable screen blocker click").trigger("show"),$("#"+this.viewLimitContent.dialogId).find(".coupon-code").select(),C.logger.doSessionLog({viewlimitmodal_seen:1}),this.listenToPrimaryBtnClick()},listenToPrimaryBtnClick:function(){$("#"+this.viewLimitContent.dialogId).find(".main-button").on("click",$.proxy(function(t){t.preventDefault(),C.logger.doSessionLog({viewlimitmodal_cta_click:1}),$.ajax({url:C.global.cheggSiteUrl+"signout",data:{token:C.global.csrfToken},context:this}).done(function(){window.location.href=this.model.get("addToCartUrl")})},this))}})),C("viewlimitmodal"),C.viewlimitmodal.model=C.Model.extend({objName:"C.viewlimitmodal.model",initialize:function(){this.getSubsData(),this.getCouponCode()},getSubsData:function(){$.ajax({url:"/_ajax/hwh/subscription/",data:{token:C.global.csrfToken},context:this,success:function(t){if(t){var t=t.subsPriceData,e="undefined"!=typeof t.monthly?t.monthly.catalogId:null,i="undefined"!=typeof t.monthly?t.monthly.priceId:null,o=e&&i?this.buildAddToCartUrl(e,i):"";this.set("addToCartUrl",o)}}})},getCouponCode:function(){$.ajax({url:"/_ajax/hwh/coupon/",data:{token:C.global.csrfToken},context:this,success:function(t){t&&(this.set("couponSavings","undefined"!=typeof t.couponSavings?t.couponSavings:""),this.set("couponCode","undefined"!=typeof t.couponCode?t.couponCode:""))},error:function(){C.utility.refresh()}}).done(function(t){this.trigger("couponDataRetrieved")})},buildAddToCartUrl:function(t,e){return"/shoppingcart/add/?redirect=hwh&command="+t+","+e+",1"}}),Eggshell.define("C.common.cspricemodal",{inputs:["show cs price modal","set type","update price","set headline","set list content","destroy on close"],outputs:[]},C.View.extend({initialize:function(t){this.data=$.extend({type:"",alcItemId:""},t),this.model=new C.cspricemodal.model(this.data),this.model.on("subsDataCaptured",this.createComponent,this),this.fireAdobePaywallEvent()},fireAdobePaywallEvent:function(){C.adobeAnalytics.setData("page",{pageInfo:{pageType:"promotion",pageName:"CS Paywall"},category:{primaryCategory:"Chegg",subCategory1:"Web",subCategory2:"cs"}}),C.adobeAnalytics.track("pageView")},createComponent:function(){this.setUpListeners(),this.Eggshell.trigger("loaded")},priceTemplate:_.template('<div class="radio-input"><input type="radio" name="cs-radio" <%= checked %> id="<%= option %>" data-priceid="<%= priceId %>" data-catalogid="<%= catalogId %>" data-catalogsource="<%= catalogItemSource %>"/><label class="form-radio <%= hide %>" for="<%= option %>">&nbsp;</label><label for="<%= option %>"><span class="radio-label">$<%= label %></span> <div class="radio-term"><%= term %></div></label></div>'),createPopup:function(){if("undefined"==typeof this.popup){this.popup=Eggshell.create("C.Eggshell.dialog");var t="chkout"===this.data.page?"Update":"Continue";this.popup.trigger("hide sub headline").trigger("hide icon").trigger("enable default control").trigger("set primary button",t).trigger("set id","cspricemodal"),this.displayPopupContent()}this.popup.trigger("show"),"chkout"!==this.data.page&&this.setInitialState();var e=C.global.userUuid||this.data.userSignedIn;e||this.popup.trigger("set secondary button","Sign In"),this.setDialogListeners()},displayPopupContent:function(){var t={el:"#"+this.popup.getId(),priceTemplate:this.priceTemplate,trialPeriod:this.model.getTrialPeriod(),page:this.data.page,type:this.data.type};this.model.get("alcOptionExists")&&Eggshell.create("C.common.cspricemodal.alacarte",{subsPriceData:this.model.get("subsPriceData")}).trigger("render",t),Eggshell.create("C.common.cspricemodal.subscription",{subsPriceData:this.model.get("subsPriceData"),alcOptionExists:this.model.get("alcOptionExists")}).trigger("render",t)},setDialogListeners:function(){this.listenToPrimaryBtnClick(),this.listenToSecondaryBtnClick(),this.listenToRadioBtnChange(),this.destroyOnClose&&this.listenToCloseBtnClick()},listenToCloseBtnClick:function(){this.popup.listen("hidden",$.proxy(function(t){Eggshell.find(this.popup).trigger("destroy")},this))},listenToPrimaryBtnClick:function(){this.popup.listen("primary button clicked",$.proxy(function(){"chkout"!==this.data.page?window.location.href=this.model.getAddToCartUrl(this.catalogId,this.priceId,this.catalogItemSource):(this.popup.trigger("hide"),this.Eggshell.trigger("update price"))},this)),C.adobeAnalytics.track("cs_paywall")},listenToSecondaryBtnClick:function(){var t=this;this.popup.listen("secondary button clicked",function(){C.logger.doSessionLog({signup_flow:"hwhv1"},function(){C.utility.navigate("/auth?redirect="+window.location.pathname)})})},listenToRadioBtnChange:function(){$("input[type=radio]").on("change",$.proxy(function(t){this.Eggshell.trigger("option selected",{priceId:$(t.target).data("priceid"),catalogId:$(t.target).data("catalogid"),catalogItemSource:$(t.target).data("catalogsource")})},this))},setUpListeners:function(){this.Eggshell.on("show cs price modal",this.createPopup).on("set type",this.setType).on("option selected",this.updateSelection).on("set headline",this.setHeadline).on("set list content",this.setListContent).on("destroy on close",this.setDestroyOnClose)},setDestroyOnClose:function(t,e){this.destroyOnClose=!0},setHeadline:function(t,e){this.headline=e},setListContent:function(t,e){this.listContent=e},setInitialState:function(){var t=$(".cs-wrapper").find("input[name=cs-radio]").data("priceid"),e=$(".cs-wrapper").find("input[name=cs-radio]").data("catalogid"),i=$(".cs-wrapper").find("input[name=cs-radio]").data("catalogsource");this.updateSelection(this,{priceId:t,catalogId:e,catalogItemSource:i}),this.model.get("alcOptionExists")||C.utility.setCookie("alcItemId",null,0),C.utility.setCookie("csPriceModalType",this.data.type)},updateSelection:function(t,e){this.catalogId=e.catalogId,this.priceId=e.priceId,this.catalogItemSource=e.catalogItemSource;var i={priceId:e.priceId,catalogId:e.catalogId,catalogItemSource:e.catalogItemSource,price:this.model.getPriceGivenPriceId(e.priceId),desc:this.model.getDesc(e.priceId,e.catalogId),term:this.model.getTermGivenPriceId(e.priceId),trialPeriod:this.model.getTrialPeriod()};C.utility.setLocal("priceSelectedData",i)},setType:function(t,e){this.data.type=e}})),C("cspricemodal"),C.cspricemodal.model=C.Model.extend({objName:"C.cspricemodal.model",initialize:function(t){this.data=t,this.getSubsData()},getSubsData:function(){$.ajax({url:"/_ajax/hwh/subscription/",type:"GET",data:{token:C.global.csrfToken,alcItemId:this.data.alcItemId,page:this.data.page,csPriceModal:!0},context:this,success:function(t){this.set("subsPriceData",t.subsPriceData)},error:function(){C.utility.refresh()}}).done(function(t){this.set("annualOptionExists",this.annualOptionExists()),this.set("alcOptionExists",this.alcItemExists()),this.set("offerType",this.getOfferType()),this.trigger("subsDataCaptured")})},annualOptionExists:function(){return"undefined"!=typeof this.get("subsPriceData").yearly},alcItemExists:function(){return"undefined"!=typeof this.get("subsPriceData").alacarte&&"undefined"!=typeof this.get("subsPriceData").alacarte.prices&&"undefined"!=typeof this.get("subsPriceData").alacarte.prices.price},getOfferType:function(){return this.hasFreeTrial()?"free-trial":this.get("annualOptionExists")?this.get("annualOptionExists")&&!this.get("alcOptionExists")?"monthly-and-annual":this.get("alcOptionExists")?"alacarte":"monthly-only":"monthly-only"},getAddToCartUrl:function(t,e,i){return"/shoppingcart/add/?redirect=hwh&command="+t+","+e+",1,"+i},getPriceGivenPriceId:function(t){return this.get("subsPriceData").monthly.priceId===t?this.get("subsPriceData").monthly.price:this.get("annualOptionExists")&&this.get("subsPriceData").yearly.priceId===t?this.get("subsPriceData").yearly.price:this.get("subsPriceData").alacarte.prices.price},getDesc:function(t,e){return this.get("subsPriceData").monthly.priceId===t?this.get("subsPriceData").monthly.desc:this.get("annualOptionExists")&&this.get("subsPriceData").yearly.priceId===t?this.get("subsPriceData").yearly.desc:this.get("alcOptionExists")&&this.get("subsPriceData").alacarte.catalogItemId==e?this.get("subsPriceData").alacarte.desc:""},getTermGivenPriceId:function(t){return this.get("subsPriceData").monthly.priceId===t?"month":this.get("annualOptionExists")&&this.get("subsPriceData").yearly.priceId===t?"year":""},hasFreeTrial:function(){return parseInt(this.get("subsPriceData").monthly.trialPeriod)<parseInt(this.get("subsPriceData").monthly.renewalPeriod)},getTrialPeriod:function(){return this.hasFreeTrial()?this.get("subsPriceData").monthly.trialPeriod:""}}),Eggshell.define("C.common.cspricemodal.alacarte",{inputs:["render"],outputs:[]},C.View.extend({initialize:function(t){this.data=$.extend({type:"",alcItemId:""},t),this.model=new C.cspricemodal.alacarte.model({subsPriceData:this.data.subsPriceData}),this.setUpListeners()},alcContent:{alcFineprint:"Access limited to the chegg.com website. Excludes mobile app access.",alcSubheaderTBS:"This Textbook Solution",alcSubheaderQNA:"This answer"},setUpListeners:function(){this.Eggshell.on("render",this.render)},render:function(t,e){this.el=e.el.split(".").join("-");var i=this.getALaCarteMarkup(e);$(this.el).find(".content").append(i)},getALaCarteMarkup:function(t){var e="tbs"===t.type?this.alcContent.alcSubheaderTBS:this.alcContent.alcSubheaderQNA,i=this.model.getAlcContent(),o="tbs"===t.type?'<div class="tbs-chapter">Chapter '+i.chapter+", Problem "+i.problem+'</div><div class="tbs-title">'+i.bookTitle+"</div>":'<div class="qna-body">'+i.qnaBody+"</div>",s='<div class="alc-radio">'+t.priceTemplate({checked:"checked",option:"alcarte",label:this.model.getALaCartePrice(),term:this.model.getAlcBillingText(),priceId:this.model.getAlcPriceId(),catalogId:this.model.getAlcCatalogId(),hide:""})+"</div>";return'<div class="cs-wrapper"><div class="cs-subheadline">'+e+'</div><div class="alc-content">'+o+'</div><div class="cs-fineprint">'+this.alcContent.alcFineprint+"</div>"+s+"</div>"}})),C("cspricemodal.alacarte"),C.cspricemodal.alacarte.model=C.Model.extend({objName:"C.cspricemodal.alacarte.model ",initialize:function(t){this.subsPriceData=t.subsPriceData},getALaCartePrice:function(){return this.subsPriceData.alacarte.prices.price},isTBSAlcItem:function(){return-1!==this.subsPriceData.alacarte.type.indexOf("TBS")?!0:!1},getAlcContent:function(){var t={};return this.isTBSAlcItem()?(t.bookTitle=this.subsPriceData.alacarte.bookTitle,t.chapter=this.subsPriceData.alacarte.chapterName,t.problem=this.subsPriceData.alacarte.problemName):(t.qnaBody=this.subsPriceData.alacarte.body,this.subsPriceData.alacarte.transcribedData&&(t.qnaBody=JSON.parse(this.subsPriceData.alacarte.transcribedData).text)),t},getAlcPriceId:function(){return this.subsPriceData.alacarte.prices.logId;

},getAlcCatalogId:function(){return this.subsPriceData.alacarte.catalogItemId},getAlcBillingText:function(){return this.isTBSAlcItem()?"1 solution":"1 answer"}}),Eggshell.define("C.common.cspricemodal.subscription",{inputs:["render"],outputs:[]},C.View.extend({initialize:function(t){this.data=$.extend({type:""},t),this.model=new C.cspricemodal.subscription.model({subsPriceData:this.data.subsPriceData}),this.setUpListeners()},subsContent:{tbsLi:"<li>Step-by-step Textbook Solutions for over 22,000 ISBNs</li>",answerLi:"<li>Get this answer and millions more</li>",qnaLi:"<li>Ask questions of experts and enthusiasts 24/7</li>",hwhLi:"<li>Search millions of homework answers</li>",tutorsMsg:'<span class="includes">INCLUDES FREE:</span> 30 minutes live, online tutoring (up to $20 value)',headlineAlc:"Select option",headlineNoTrial:"Choose monthly or annual",headlineNoAnnual:"Ace your course",csSubheader:"Chegg Study",tbsSubheader:"All Textbook Solutions and more",qnaSubheader:"All answers, Textbook Solutions and more"},setUpListeners:function(){this.Eggshell.on("render",this.render)},render:function(t,e){this.el=e.el.split(".").join("-"),$(this.el).find(".content").append(this.getCSMarkup(e)),$(this.el).find(".headline").append(this.getHeadline(e))},getHeadline:function(t){return this.data.alcOptionExists?this.subsContent.headlineAlc:this.model.hasFreeTrial()?"Start "+t.trialPeriod+"-day free trial":this.model.get("annualOptionExists")?this.subsContent.headlineNoTrial:this.subsContent.headlineNoAnnual},getCSMarkup:function(t){var e=this.model.get("annualOptionExists")||this.data.alcOptionExists?"":"hide";this.checkMonthly=this.data.alcOptionExists?"":"checked",this.checkYearly="","chkout"===t.page&&this.getCSDefaultRadio();var i='<div class="cs-radio">'+t.priceTemplate({checked:this.checkMonthly,option:"monthly",label:this.model.getMonthlyPrice(),term:this.model.getBillingText("monthly"),priceId:this.model.getMonthlyPriceId(),catalogId:this.model.getMonthlyCatalogId(),catalogItemSource:this.model.getCatalogItemSource(),hide:e});this.model.get("annualOptionExists")&&(i+=t.priceTemplate({checked:this.checkYearly,option:"yearly",label:this.model.getAnnualPrice(),term:this.model.getBillingText("annually"),priceId:this.model.getAnnualPriceId(),catalogId:this.model.getAnnualCatalogId(),catalogItemSource:this.model.getCatalogItemSource(),hide:e})),i+="</div>";var o=this.subsContent.csSubheader;this.data.alcOptionExists&&(o=this.model.isTBSAlcItem()?this.subsContent.tbsSubheader:this.subsContent.qnaSubheader);var s='<div class="cs-wrapper"><div class="cs-subheadline">'+o+"</div>"+this.getCSListContent()+i+"</div>";return s+='<div class="tutor-messaging">'+this.subsContent.tutorsMsg+"</div>"},getCSDefaultRadio:function(){if(C.utility.getLocal("priceSelectedData")){var t=C.utility.getLocal("priceSelectedData").desc;this.checkMonthly="",this.checkYearly="",-1!==t.indexOf("annual")?this.checkYearly="checked":-1!==t.indexOf("monthly")&&(this.checkMonthly="checked")}},getCSListContent:function(){var t="";return t+="qna"===this.data.type?this.subsContent.answerLi+this.subsContent.tbsLi+this.subsContent.qnaLi:this.subsContent.tbsLi+this.subsContent.qnaLi+this.subsContent.hwhLi,'<ul class="cs-list">'+t+"</ul>"}})),C("cspricemodal.subscription"),C.cspricemodal.subscription.model=C.Model.extend({objName:"C.cspricemodal.subscription.model",initialize:function(t){this.data=t,this.subsPriceData=t.subsPriceData,this.set("annualOptionExists",this.annualOptionExists())},annualOptionExists:function(){return"undefined"!=typeof this.subsPriceData.yearly},isTBSAlcItem:function(){return this.data.alcOptionExists&&-1!==this.subsPriceData.alacarte.type.indexOf("TBS")?!0:!1},getMonthlyPrice:function(){return this.subsPriceData.monthly.price},getAnnualPrice:function(){return this.get("annualOptionExists")?this.subsPriceData.yearly.price:""},getMonthlyPriceId:function(){return this.subsPriceData.monthly.priceId},getAnnualPriceId:function(){return this.get("annualOptionExists")?this.subsPriceData.yearly.priceId:""},getMonthlyCatalogId:function(){return this.subsPriceData.monthly.catalogId},getAnnualCatalogId:function(){return this.get("annualOptionExists")?this.subsPriceData.yearly.catalogId:""},hasFreeTrial:function(){return parseInt(this.subsPriceData.monthly.trialPeriod)<parseInt(this.subsPriceData.monthly.renewalPeriod)},getBillingText:function(t){return this.hasFreeTrial()?t+" after trial":t},getCatalogItemSource:function(){return this.subsPriceData.monthly.catalogItemSource}}),Eggshell.define("C.common.onboardingoverlay",{inputs:{render:{payload:null},set_instruction_points:{payload:"object"},render_header_overlay:{payload:null},show_close_control:{payload:null},dismiss_on_click:{payload:null},set_on_click_callback:{payload:null},hide_overlay:{payload:null}},outputs:[]},function(){var t=Backbone.View.extend({initialize:function(){this.instructionPoints=[],this.showCloseControl=!1,this.dismissOnClick=!1,this.onClickCallback=null,this.$headerHandle=$(C.dom&&C.dom.$header?C.dom.$header:".chgg-hdr"),this.origHeaderBorder=this.$headerHandle?this.$headerHandle.css("border-bottom"):"",Eggshell.find(this).on("render",this.render,this).on("show_overlay_close",this.setShowCloseControl,this).on("hide_overlay",this.hideOverlay,this).on("dismiss_on_click",this.setDismissOnClick,this).on("set_on_click_callback",this.setOnClickCallback,this).on("render_header_overlay",this.setRenderHeaderOverlay,this).on("set_instruction_points",this.setInstructionPoints,this)},render:function(){this.$el.prepend(this.overlayTemplate({showCloseControl:this.showCloseControl})),this.renderHeaderOverlay&&(this.$headerHandle.prepend(this.headerOverlayTemplate({})),this.$headerHandle.css({"border-bottom":"none"})),this.showCloseControl&&this.$el.find(".onboardingoverlay-close").css({top:this.$el.parent().position().top+50});for(var t=0;t<this.instructionPoints.length;t++){this.instructionPoints[t].id=t;var e=this.instructionPoints[t];$(e.handle).append(this.instructionPointTemplate({id:e.id,top:e.top_padding,left:e.left_padding,img:e.img}))}C.logger.doSessionLog({onboarding_overlay_opened:1}),this.setActionListeners()},setInstructionPoints:function(t,e){if(!e||"object"!=typeof e)throw"Invalid instruction point. Type needs to be an object value.";$.extend(this.instructionPoints,e)},setShowCloseControl:function(t,e){this.showCloseControl=!0},setDismissOnClick:function(t,e){this.dismissOnClick=!0},setRenderHeaderOverlay:function(t,e){this.renderHeaderOverlay=!0},setOnClickCallback:function(t,e){this.onClickCallback=e},setActionListeners:function(){this.showCloseControl&&$(".onboardingoverlay-close").on("click",$.proxy(function(t){Eggshell.find(this).trigger("hide_overlay")},this)),this.dismissOnClick&&$(".onboardingoverlay-screenblocker, .onboardingoverlay-header-screenblocker").on("click",$.proxy(function(t){Eggshell.find(this).trigger("hide_overlay"),this.onClickCallback&&this.onClickCallback()},this))},hideOverlay:function(){C.logger.doSessionLog({onboarding_overlay_closed:1}),$(".onboardingoverlay-header-screenblocker, .onboardingoverlay-screenblocker").remove(),$(".onboardingoverlay-instruction-point").remove(),this.$headerHandle.css({"border-bottom":this.origHeaderBorder}),Eggshell.find(this).trigger("destroy")},headerOverlayTemplate:_.template('<div class="onboardingoverlay-header-screenblocker"></div>'),overlayTemplate:_.template('<% if(showCloseControl){ %><div class="onboardingoverlay-close"></div><% } %><div class="onboardingoverlay-screenblocker"></div>'),instructionPointTemplate:_.template('<div class="onboardingoverlay-instruction-point point-<%- id %>" style="top:<%- top %>px; left:<%- left %>px;"><img src="http://c.cheggcdn.com/_public-assets/<%- img %>"/></div>')});return t}()),Eggshell.define("C.common.onboardingsequence",{inputs:{render:{payload:null},set_banner_text:{payload:"string"},set_banner_button_text:{payload:"string"},set_banner_handle:{payload:"selector"},set_obfuscation_handle:{payload:"selector"},set_instruction_points:{payload:"object"},begin_sequence:{payload:null},disable_header_obfuscation:{payload:null},disable_step_counter:{payload:null},apply_custom_css_prefix:{payload:"string"}},outputs:["sequence_started","step_viewed","sequence_completed","close_button_clicked"]},function(){var t=Backbone.View.extend({initialize:function(){this.$obfuscationHandle=null,this.$bannerHandle=null,this.$headerHandle=$(C.dom&&C.dom.$header?C.dom.$header:".chgg-hdr"),this.origHeaderBorder=this.$headerHandle?this.$headerHandle.css("border-bottom"):"",this.bannerText="Welcome to Chegg Study, your start to better grades",this.bannerButtonText="Show me around",this.cssPrefix="onboardingsequence",this.instructionPoints=[],this.tooltipSequence=[],this.currentTooltipIndex=null,this.sequenceStarted=!1,this.headerObfuscationEnabled=!0,this.disableStepCounter=!1,Eggshell.find(this).on("render",this.render,this).on("set_instruction_points",this.setInstructionPoints,this).on("set_banner_text",this.setBannerText,this).on("set_banner_button_text",this.setBannerButtonText,this).on("set_banner_handle",this.setBannerHandle,this).on("set_obfuscation_handle",this.setObfuscationHandle,this).on("disable_header_obfuscation",this.disableHeaderObfuscation,this).on("disable_step_counter",this.setDisableStepCounter,this).on("apply_custom_css_prefix",this.setCustomCssPrefix,this).on("begin_sequence",this.beginSequence,this)},render:function(){this.getCleanTooltips(),this.renderObfuscation(),this.renderTooltips(),this.renderBanner(),this.addBodyClickListener()},renderObfuscation:function(){this.$obfuscationHandle&&(this.$obfuscationHandle.prepend(this.obfuscationTemplate({})),this.headerObfuscationEnabled&&(this.$headerHandle.append(this.headerObfuscation({})),this.$headerHandle.css({"border-bottom":"none"})))},renderBanner:function(){this.$bannerHandle&&($(this.bannerTemplate({text:this.bannerText,buttonText:this.bannerButtonText})).insertAfter(this.$bannerHandle),this.attachBannerButtonListener())},renderTooltips:function(){for(var t=0;t<this.instructionPoints.length;t++){var e=this.instructionPoints[t],i=Eggshell.create("C.common.overlay.tooltip"),o=t+1;switch(i.on("return tooltip content node",$.proxy(function(t,s){var n=s;n.html(this.instructionPointContentTemplate({stepNumber:o,content:e.content,buttonText:o==this.instructionPoints.length?"GOT IT":"NEXT",total:this.instructionPoints.length,cssPrefix:this.cssPrefix,disableStepCounter:this.disableStepCounter})),this.attachButtonListener(i)},this)).trigger("set target",$(e.handle.selector)).trigger("disable tooltip on hover").trigger("disable_max_z_index").trigger("enable close button").trigger("get tooltip content node"),e.position){case"left":i.trigger("set tooltip on the left of target");break;case"right":i.trigger("set tooltip on the right of target");break;case"top":i.trigger("set tooltip above target"),i.trigger("position caret center");break;case"bottom":i.trigger("set tooltip below target"),i.trigger("top-right"===e.caretPosition?"position caret on top right":"position caret center")}e.tooltipWidth&&i.trigger("set tooltip the width",e.tooltipWidth);var s=i.getId().replace(".","-");$("#"+s).addClass(this.cssPrefix+"-tooltip");var n=e.highlightHandle?e.highlightHandle:"";this.tooltipSequence.push({tooltip:i,highlight:n})}},getCleanTooltips:function(){for(var t=0;t<this.instructionPoints.length;t++){var e=$(this.instructionPoints[t].handle.selector);e.length||this.instructionPoints.splice(t,1)}},beginSequence:function(){this.sequenceStarted=!0,$.each(this.tooltipSequence,function(t,e){e.tooltip.trigger("hide")}),this.tooltipSequence&&this.tooltipSequence[0]&&(this.currentTooltipIndex=0,this.showTooltip(this.tooltipSequence[0].tooltip,this.tooltipSequence[0].highlight,this.currentTooltipIndex+1))},showNextTooltip:function(t){this.tooltipSequence[this.currentTooltipIndex].tooltip.trigger("hide");var e=this.currentTooltipIndex+1,i=this.tooltipSequence[this.currentTooltipIndex].highlight;if(e<this.tooltipSequence.length){var o=this.tooltipSequence[e].tooltip,s=this.tooltipSequence[e].highlight;this.currentTooltipIndex=e,this.removeHighlight(i),t&&Eggshell.find(this).trigger("step_viewed",{stepNumber:this.currentTooltipIndex}),this.showTooltip(o,s,this.currentTooltipIndex+1)}else this.removeObfuscation(),this.removeHighlight(i),this.scrollTo(0),this.removeBodyClickListener(),t&&Eggshell.find(this).trigger("step_viewed",{stepNumber:this.currentTooltipIndex+1}),Eggshell.find(this).trigger("sequence_completed")},attachButtonListener:function(t){var e=t.getId().replace(".","-"),i="#"+e;$(i+" .onboarding-tooltip-btn").on("click",$.proxy(function(t){t.stopPropagation(),this.showNextTooltip(!0)},this)),$(i+" .close-btn").on("click",$.proxy(function(e){e.preventDefault(),e.stopPropagation();var o=$(i).find("."+this.cssPrefix+"-instruction-point").data("step"),s=this.tooltipSequence[o-1].highlight;Eggshell.find(this).trigger("close_button_clicked",{stepNumber:o}),this.removeObfuscation(),this.removeHighlight(s),t.trigger("hide"),this.removeBodyClickListener(),Eggshell.find(this).trigger("sequence_completed")},this))},attachBannerButtonListener:function(){$(".onboarding-banner-btn").on("click",$.proxy(function(t){t.stopPropagation(),Eggshell.find(this).trigger("sequence_started"),$(".onboarding-banner").animate({height:0,opacity:0},400,$.proxy(function(){$(".onboarding-banner").remove(),this.beginSequence()},this))},this))},showTooltip:function(t,e,i){var o=t.getId().replace(".","-");t.trigger("show"),this.addHighlight(e),this.scrollTo($("#"+o).position().top-200)},addHighlight:function(t){t[0].style.pointerEvents="none",$(t).addClass("onboarding-sequence-highlight")},removeHighlight:function(t){t[0].style.pointerEvents="auto",$(t).removeClass("onboarding-sequence-highlight")},addBodyClickListener:function(){$("body").bind("click",$.proxy(this.onBodyClick,this))},removeBodyClickListener:function(){$("body").unbind("click",$.proxy(this.onBodyClick,this))},onBodyClick:function(){this.sequenceStarted?this.showNextTooltip():$(".onboarding-banner").animate({height:0,opacity:0},400,$.proxy(function(){$(".onboarding-banner").remove(),this.beginSequence()},this))},setInstructionPoints:function(t,e){if(!e||"object"!=typeof e)throw"Invalid instruction point. Type needs to be an object value.";$.extend(this.instructionPoints,e)},setBannerText:function(t,e){this.bannerText=e},setBannerButtonText:function(t,e){this.bannerButtonText=e},setBannerHandle:function(t,e){this.$bannerHandle=e},setObfuscationHandle:function(t,e){this.$obfuscationHandle=e},removeObfuscation:function(){$(".onboarding-sequence-obfuscation").remove(),$(".onboarding-sequence-header-obfus").remove(),this.$headerHandle.css({"border-bottom":this.origHeaderBorder})},disableHeaderObfuscation:function(){this.headerObfuscationEnabled=!1},setDisableStepCounter:function(){this.disableStepCounter=!0},setCustomCssPrefix:function(t,e){this.cssPrefix=e},instructionPointContentTemplate:_.template('<div class="<%=cssPrefix%>-instruction-point" data-step="<%= stepNumber %>"><% if(!disableStepCounter){ %><span class="instruction-point-counter"><%= stepNumber %> of <%= total %></span><% } %> <span class="instruction-point-content"><%= content %></span><button class="onboarding-tooltip-btn btn-primary-outline btn-sm"><%= buttonText %></button></div>'),bannerTemplate:_.template('<div class="onboarding-banner"><span class="message-text"><%= text %> <button class="onboarding-banner-btn btn-primary-outline btn-mini"><%= buttonText %></button></span></div>'),obfuscationTemplate:_.template('<div class="onboarding-sequence-obfuscation"></div>'),headerObfuscation:_.template('<div class="onboarding-sequence-header-obfus"></div>'),scrollTo:function(t){$("body, html").animate({scrollTop:t})}});return t}()),C.resource.add("C.common.question.form.title","Post new question"),C.resource.add("C.common.question.form.subtitle","Expert answers in as little as 30 minutes"),C.resource.add("C.common.question.form.label","Continue to edit and attach image(s)."),C.resource.add("C.common.question.form.label.questioncount","{0} questions remaining"),C.resource.add("C.common.question.form.button","Continue to post"),Eggshell.define("C.common.question.form",{inputs:["render","set question body","set placeholder text","set form title","set form subtitle","set form button","set source","show remaining questions"],outputs:{rendered:{payload:null}}},function(){var t=C.Model.extend({getRemainingQuestions:function(t){$.ajax({url:"/_ajax/cs/usage",type:"get",dataType:"json",data:{token:C.global.csrfToken,whitelist:{remainingQuestions:{options:null}}},context:this,success:function(e){this.set("userData",e),"undefined"!=typeof t&&this.trigger(t)},error:function(t){console.log("Error retrieving post question form data")}})}}),e=C.View.extend({tmpl:_.template('<div class="post-question-form-wrapper"><div class="title"><%- label.title %></div><div class="subtitle"><%- label.subtitle %></div><form action="<%- url %>study/qa/post" method="post" name="questionform"><textarea placeholder="<%- placeholderText %>" name="questionBody"><%- questionBody %></textarea><button class="btn btn-flat-sm"><%- label.button %></button><div class="label"><%- label.label %></div></form></div>'),events:{"click button":"formSubmit"},initialize:function(e){this.model=new t,this.model.on("render_module",this.render,this),this.opts=e,this.questionBody="",this.formTitle=C.resource.fetch("C.common.question.form.title"),this.formSubtitle=C.resource.fetch("C.common.question.form.subtitle"),this.formLabel=C.resource.fetch("C.common.question.form.label"),this.buttonText=C.resource.fetch("C.common.question.form.button"),this.placeholderText="",this.showRemainingQuestions=!1,this.source="questionform",Eggshell.find(this).on("set source",this.setSource,this).on("set question body",this.setQuestionBody,this).on("set form title",this.setFormTitle,this).on("set form subtitle",this.setFormSubtitle,this).on("set form label",this.setFormLabel,this).on("set button text",this.setButtonText,this).on("set placeholder text",this.setPlaceholderText,this).on("show remaining questions",this.setShowRemainingQuestions,this).on("render",this.load,this)},load:function(){this.showRemainingQuestions?this.model.getRemainingQuestions("render_module"):this.render()},render:function(){var t=this.model.get("userData"),e=t&&t.remainingQuestions&&null!=t.remainingQuestions?C.resource.fetch("C.common.question.form.label.questioncount",[t.remainingQuestions]):this.formLabel;this.$el.html(this.tmpl({url:C.global.cheggSiteSecureUrl,questionBody:this.questionBody,placeholderText:this.placeholderText,label:{title:this.formTitle,subtitle:this.formSubtitle,label:e,button:this.buttonText}})),Eggshell.find(this).trigger("rendered")},setSource:function(t,e){this.source=e},setQuestionBody:function(t,e){if(!e||"string"!=typeof e)throw"Invalid question body. Type needs to be a string value.";this.questionBody=e},setFormTitle:function(t,e){if(!e||"string"!=typeof e)throw"Invalid form title. Type needs to be a string value.";this.formTitle=e},setFormSubtitle:function(t,e){if(!e||"string"!=typeof e)throw"Invalid form subtitle. Type needs to be a string value.";this.formSubtitle=e},setFormLabel:function(t,e){if(!e||"string"!=typeof e)throw"Invalid form label. Type needs to be a string value.";this.formLabel=e},setButtonText:function(t,e){if(!e||"string"!=typeof e)throw"Invalid button text. Type needs to be a string value.";this.buttonText=e},setPlaceholderText:function(t,e){if(!e||"string"!=typeof e)throw"Invalid placeholder text. Type needs to be a string value.";this.placeholderText=e},setShowRemainingQuestions:function(t,e){this.showRemainingQuestions=e},formSubmit:function(t){t.preventDefault(),C.logger.doSessionLog({post_button_click:this.source},$.proxy(function(){this.$el.find('form[name="questionform"]').submit()},this),{logSubscription:1})}});return e}()),C.resource.add("C.Eggshell.text.ellipses.more-link","Show more"),Eggshell.define("C.Eggshell.text.ellipsis",{inputs:["set text","set lines","get text","change more link copy","display more link","display more link with quotes","always display more link"],outputs:["original text","redrawn","read more clicked"]},C.View.extend({text:null,lines:1,textNodes:[],initialize:function(){this.moreText=C.resource.fetch("C.Eggshell.text.ellipses.more-link"),this.render(),this.registerListeners()},destroy:function(){if(this.textNodes)for(;this.textNodes.length;){var t=this.textNodes.pop();t.unwatch&&t.unwatch()}},render:function(t){if(this.text){var e=this.lines;this.$el.empty();var i=$("<div>").appendTo(this.$el);if(t){if(t&&"a.more-link"==t.after){var o="#";t.link&&(o=t.link);var s=this.text+' <a href="'+o+'" class="more-link">'+this.moreText+"</a>";i.html(s),e++}else if(t&&"span.last-element"==t.after){var o="#";t.link&&(o=t.link);var s='<span class="start-quote"></span> '+this.text+' <span class="last-element"><span class="end-quote"></span> <a href="'+o+'" class="more-link">'+this.moreText+"</a></span>";i.html(s),e++}}else i.html(this.text);var n=this.$el.css("line-height");n&&"0px"!=n||(n=this.$el.css("font-size")),n=parseInt(n);var r=e*n,a={height:r+1,watch:!0};t&&(a=$.extend(a,t));var l=a.callback;a.callback=$.proxy(function(){$.isFunction(l)&&l.apply(this,arguments),this.Eggshell.trigger("redrawn",arguments)},this),i.addClass("truncated-container"),i.dotdotdot(a),i.css({"line-height":n+"px","max-height":r+"px",overflow:"hidden"}),this.textNodes.push(i)}},registerListeners:function(){this.Eggshell.listen("set text",function(t,e){if(("undefined"==typeof e||null==e)&&(e=""),!e||"string"!=typeof e)throw"Invalid text";this.text=e,this.render()}),this.Eggshell.listen("set lines",function(t,e){if(!e||"number"!=typeof e)throw"Invalid lines";this.lines=e,this.render()}),this.Eggshell.listen("get text",function(t,e){this.Eggshell.trigger("original text",this.text)}),this.Eggshell.listen("display more link",function(t,e){this.opts={after:"a.more-link",callback:function(t,e){0==t&&this.$(".more-link").hide()}},this.options.alwaysDisplayMoreLink&&(this.opts.callback=function(){}),e&&"string"==typeof e&&(this.opts.link=e),this.render(this.opts)}),this.Eggshell.listen("display more link with quotes",function(t,e){this.opts={after:"span.last-element",callback:function(t,e){0==t&&this.$(".more-link").hide()}},this.options.alwaysDisplayMoreLink&&(this.opts.callback=function(){}),e&&"string"==typeof e&&(this.opts.link=e),this.render(this.opts)}),this.Eggshell.listen("change more link copy",function(t,e){if(!e||"string"!=typeof e)throw"Invald payload. needs to be string";this.moreText=e}),this.Eggshell.listen("always display more link",function(t,e){this.options.alwaysDisplayMoreLink=!0}),this.Eggshell.listen("destroy",this.destroy)},events:{"click .more-link":"triggerShowMore"},triggerShowMore:function(t){return"#"!=$(t.currentTarget).attr("href")?void this.Eggshell.trigger("read more clicked"):(t.preventDefault(),t.stopPropagation(),this.$el.html(this.$("div").triggerHandler("originalContent")),this.$el.find(".more-link").hide(),void this.Eggshell.trigger("read more clicked"))}})),!function(t,e){function i(t,e,i){var o=t.children(),s=!1;t.empty();for(var r=0,a=o.length;a>r;r++){var l=o.eq(r);if(t.append(l),i&&t.append(i),n(t,e)){l.remove(),s=!0;break}i&&i.detach()}return s}function o(e,i,r,a,l){var c=e.contents(),d=!1;e.empty();for(var h="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",u=0,p=c.length;p>u&&!d;u++){var g=c[u],m=t(g);"undefined"==typeof g||3==g.nodeType&&0==t.trim(g.data).length||(e.append(m),l&&e[e.is(h)?"after":"append"](l),n(r,a)&&(d=3==g.nodeType?s(m,i,r,a,l):o(m,i,r,a,l),d||(m.remove(),d=!0)),d||l&&l.detach())}return d}function s(e,i,o,s,a){var d=e[0];if(!d)return!1;for(var u=c(d),p=-1!==u.indexOf(" ")?" ":"　",g="letter"==s.wrap?"":p,m=u.split(g),b=-1,f=-1,v=0,y=m.length-1;y>=v&&(0!=v||0!=y);){var k=Math.floor((v+y)/2);if(k==f)break;f=k,l(d,m.slice(0,f+1).join(g)+s.ellipsis),n(o,s)?y=f:(b=f,v=f),y==v&&0==y&&s.fallbackToLetter&&(g="",m=m[0].split(g),b=-1,f=-1,v=0,y=m.length-1)}if(-1==b||1==m.length&&0==m[0].length){var C=e.parent();e.remove();var w=a&&a.closest(C).length?a.length:0;C.contents().length>w?d=h(C.contents().eq(-1-w),i):(d=h(C,i,!0),w||C.remove()),d&&(u=r(c(d),s),l(d,u),w&&a&&t(d).parent().append(a))}else u=r(m.slice(0,b+1).join(g),s),l(d,u);return!0}function n(t,e){return t.innerHeight()>e.maxHeight}function r(e,i){for(;t.inArray(e.slice(-1),i.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),i.lastCharacter.noEllipsis)<0&&(e+=i.ellipsis),e}function a(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function c(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function d(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function h(e,i,o){var s,n=e&&e[0];if(n){if(!o){if(3===n.nodeType)return n;if(t.trim(e.text()))return h(e.contents().last(),i)}for(s=d(n);!s;){if(e=e.parent(),e.is(i)||!e.length)return!1;s=d(e[0])}if(s)return h(t(s),i)}return!1}function u(e,i){return e?"string"==typeof e?(e=t(e,i),e.length?e:!1):e.jquery?e:!1:!1}function p(t){for(var e=t.innerHeight(),i=["paddingTop","paddingBottom"],o=0,s=i.length;s>o;o++){var n=parseInt(t.css(i[o]),10);isNaN(n)&&(n=0),e-=n}return e}function g(t,e){return t?(e="string"==typeof e?"dotdotdot: "+e:["dotdotdot:",e],"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(e),!1):!1}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return e&&e.debug===!1||g(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var s=this;s.data("dotdotdot")&&s.trigger("destroy.dot"),s.data("dotdotdot-style",s.attr("style")),s.css("word-wrap","break-word"),"nowrap"===s.css("white-space")&&s.css("white-space","normal"),s.bind_events=function(){return s.bind("update.dot",function(e,a){e.preventDefault(),e.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:p(s),l.maxHeight+=l.tolerance,"undefined"!=typeof a&&(("string"==typeof a||a instanceof HTMLElement)&&(a=t("<div />").append(a).contents()),a instanceof t&&(r=a)),b=s.wrapInner('<div class="dotdotdot" />').children(),b.empty().append(r.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var d=!1,h=!1;return c.afterElement&&(d=c.afterElement.clone(!0),c.afterElement.remove()),n(b,l)&&(h="children"==l.wrap?i(b,l,d):o(b,s,b,l,d)),b.replaceWith(b.contents()),b=null,t.isFunction(l.callback)&&l.callback.call(s[0],h,r),c.isTruncated=h,h}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(s[0],c.isTruncated),c.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(s[0],r),r}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),s.unwatch().unbind_events().empty().append(r).attr("style",s.data("dotdotdot-style")).data("dotdotdot",!1)}),s},s.unbind_events=function(){return s.unbind(".dot"),s},s.watch=function(){if(s.unwatch(),"window"==l.watch){var e=t(window),i=e.width(),o=e.height();e.bind("resize.dot"+c.dotId,function(){i==e.width()&&o==e.height()&&l.windowResizeFix||(i=e.width(),o=e.height(),h&&clearInterval(h),h=setTimeout(function(){s.trigger("update.dot")},10))})}else d=a(s),h=setInterval(function(){var t=a(s);(d.width!=t.width||d.height!=t.height)&&(s.trigger("update.dot"),d=a(s))},100);return s},s.unwatch=function(){return t(window).unbind("resize.dot"+c.dotId),h&&clearInterval(h),s};var r=s.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),c={},d={},h=null,b=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),c.afterElement=u(l.after,s),c.isTruncated=!1,c.dotId=m++,s.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&s.watch(),s},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}};var m=1,b=t.fn.html;t.fn.html=function(i){return i!=e&&!t.isFunction(i)&&this.data("dotdotdot")?this.trigger("update",[i]):b.apply(this,arguments)};var f=t.fn.text;t.fn.text=function(i){return i!=e&&!t.isFunction(i)&&this.data("dotdotdot")?(i=t("<div />").text(i).html(),this.trigger("update",[i])):f.apply(this,arguments)}}}(jQuery),Eggshell.define("C.common.tbspopup",{inputs:["show tbs popup","show tbs popup in sidebar","go to solution"],outputs:[],singleton:!0},C.View.extend({initialize:function(t){this.data=$.extend({},t),this.setTBSContent(),this.setUpListeners()},setTBSContent:function(){this.tbsDialog=Eggshell.create("C.Eggshell.dialog");var t='<fieldset class="chg-util-autosuggest-form"><input type="text" class="chg-form-sm has-default" placeholder="Enter ISBN, Title or Author\'s Name" name="search_by" autocomplete="off" autofocus></fieldset>';this.tbsDialog.trigger("hide sub headline").trigger("hide icon").trigger("set content html",t)},setUpListeners:function(){this.Eggshell.on("show tbs popup",this.showTBSPopup),this.Eggshell.on("show tbs popup in sidebar",this.showSidebarTbs)},showTBSPopup:function(t,e){this.doAutoComplete(),this.tbsDialog.trigger("set headline","Find your textbook to view solutions").trigger("show"),$(".C-common-tbspopup").next().find(".dialog").css({overflow:"visible"})},showSidebarTbs:function(t,e){this.doAutoComplete(),this.tbsDialog.trigger("set headline","View textbook solutions").trigger("show"),this.displayBookList(),this.tbsDialog.on("hidden",this.emptyBookList)},displayBookList:function(){$(".chg-util-autosuggest-form").append('<div class="book-list-container"><div class="book-list"></div></div>'),this.EggLoading=Eggshell.create("C.Eggshell.loading.inline",{el:$(".book-list")});var t=this,e=Eggshell.create("C.Eggshell.studysolution.book",{el:$(".book-list")}).listen("ready",function(){t.EggLoading.trigger("hide"),$(".book-list li").length&&$(".book-list-container").prepend('<div class="book-list-header">RECENTLY VIEWED</div>')}).trigger("render");this.hideBookList()},hideBookList:function(){$(".chg-form-sm").on("keypress",function(){var t=$(".book-list-container");t.hasClass("hidden")||t.hide()})},emptyBookList:function(){$(".book-list-header").remove(),$(".book-list-container").remove()},doAutoComplete:function(){var t=window.cev||new Events;window.cev=window.cev||t,window.cev.addEvent("searchLoad:once",$.proxy(function(t){"undefined"==typeof this.autoCompleteWidget&&(this.autoCompleteWidget=Eggshell.create("C.common.search",{el:$(".chg-util-autosuggest-form")}));var e=".chg-util-autosuggest-form input";this.autoCompleteWidget.trigger("render",{ajaxEndpoint:"/_ajax/search/tbsserp",target:$(e),filters:{type:"group",count:4,destination:"tbs"}}).trigger("show a single segway","single-tbs").trigger("show no categories").trigger("show no bottom content").trigger("set width to size of input field"),$(e).attr("placeholder","Enter book title or ISBN to view step-by-step solutions for your book..")},this))}})),C.resource.add("mytbs.title","My Textbook Solutions"),C.resource.add("mytbs.subtitle","Instant access to step-by-step solutions for your textbooks"),Eggshell.define("C.common.mytbs",{inputs:["render","set_source"],outputs:["mytbs_ready"]},function(){var t=Backbone.Model.extend({getTbsUsage:function(t){$.ajax({url:"/_ajax/cs/usage",type:"get",dataType:"json",data:{token:C.global.csrfToken,
whitelist:{combinedTbs:{options:{count:3,includeBookmarkCount:!0}}}},context:this,success:function(e){this.set("usageData",e),"undefined"!=typeof t&&this.trigger(t)},error:function(t){console.log("Error retrieving tbs usage data")}})}}),e=Backbone.View.extend({initialize:function(){this.model=new t,this.model.on("tbs_usage_data_set",this.processUsageData,this),this.source="mytbs",Eggshell.find(this).on("set_source",this.setSource,this).on("render",this.load,this).on("usage_data_ready",this.render,this)},setSource:function(t,e){this.source=e},load:function(){this.model.getTbsUsage("tbs_usage_data_set")},processUsageData:function(){var t=this.model.get("usageData"),e=t&&t.combinedTbs?t.combinedTbs:null;this.userTbs=e,this.userHasViewedTbs=null!=e&&e.length>0,Eggshell.find(this).trigger("usage_data_ready")},render:function(){this.$el.html(this.myTbsTemplate({header:C.resource.fetch("mytbs.title"),subheader:this.userHasViewedTbs?" ":C.resource.fetch("mytbs.subtitle")})),this.renderTbsSection(),this.setupActionListeners(),Eggshell.find(this).trigger("mytbs_ready")},renderTbsSection:function(){var t=3,e=0,i=$(".mytbs");if(this.userHasViewedTbs&&this.userTbs&&this.userTbs.length){for(e;e<this.userTbs.length&&t>e;e++){var o=this.userTbs[e];i.find(".mytbs-content").append(this.myTbsBook({tbs:{url:o.url,edition:"book_tbs"===o.type?C.utility.ordinal(parseInt(o.editionNo)):o.editionNo,title:o.shortTitle?o.shortTitle:o.title,bookmarkCount:o.bookmarkCount?o.bookmarkCount:""}}));var s=Eggshell.create("C.cs.tbscover",{el:i.find(".book-cover").last()});o.coverImage?s.trigger("set book image",o.coverImage):s.trigger("set book title",o.shortTitle?o.shortTitle:o.title),s.trigger("set cover size","small").trigger("render")}for(var n=i.find(".mytbs-book .short-title"),r=0;r<n.length;r++){var a=$(n[r]);a.text().split(" ").length>1?a.dotdotdot():a.addClass("truncated")}this.userTbs.length&&i.append('<a href="/study/tbs" class="mytbs-viewall">View all solutions</a>')}for(C.logger.doSessionLog({onboarding_user_tbs_shown:e}),e;t>e;e++)i.find(".mytbs-content").append(this.myTbsPlaceholderBook({}))},setupActionListeners:function(){this.$el.find(".mytbs-book").on("click",$.proxy(function(t){t.preventDefault(),t.stopPropagation();var e=$(t.currentTarget),i={onboarding_user_tbs_clicked:1};"tbs_page"===this.source&&(i={tbs_rr_click:"tbs"}),C.logger.doSessionLog(i,function(){C.utility.navigate(e.attr("href"))},{logSubscription:1})},this)),this.$el.find(".mytbs-placeholderbook").on("click",$.proxy(function(t){var e={onboarding_placeholder_tbs_clicked:1};"tbs_page"===this.source&&(e={tbs_rr_click:"placeholder"}),C.logger.doSessionLog(e,null,{logSubscription:1}),"undefined"==typeof this.findTbsPopup&&(this.findTbsPopup=Eggshell.create("C.common.tbspopup")),this.findTbsPopup.trigger("show tbs popup")},this)),this.$el.find(".mytbs-viewall").on("click",function(t){t.preventDefault(),C.logger.doSessionLog({onboarding_view_all_tbs:1},function(){C.utility.navigate("/study/tbs")})})},myTbsTemplate:_.template('<div class="mytbs"><div class="mytbs-header"><%- header %></div><div class="mytbs-subheader"><%- subheader %></div><div class="mytbs-content"></div></div>'),myTbsBook:_.template('<a href="<%= tbs.url %>" class="mytbs-book"><div class="book-cover"></div><div class="result-header short-title"><%= tbs.title %></div><div class="result-detail result-edition"><%= tbs.edition %> Edition</div><% if (tbs.bookmarkCount) { %><div class="bookmark-details"><span class="bookmark-icn"></span> <span class="count">(<%= tbs.bookmarkCount %>)</span></div><% } %></a>'),myTbsPlaceholderBook:_.template('<div class="mytbs-placeholderbook"><div class="placeholderbook-content"><div class="plus-icon"></div>Add a textbook</div></div>')});return e}()),Eggshell.define("C.cs.tbscover",{inputs:["render","set book title","set book image","set cover size"],outputs:[],strict:!1},function(){var t=Backbone.View.extend({initialize:function(t){this.opts=$.extend(t,{}),this.Eggshell.on("render",this.render,this).on("set book title",this.setBookTitle,this).on("set book image",this.setBookImage,this).on("set cover size",this.setCoverSize,this)},render:function(){this.$el.append(this.bookCoverTemplate({size:this.coverSize,bookCoverImg:this.bookCoverImg,bookCoverTxt:this.bookCoverTxt})),this.$el.find(".tbs-book-cover-title").dotdotdot().addClass("padding")},setBookTitle:function(t,e){this.bookCoverTxt=e},setCoverSize:function(t,e){this.coverSize=e},setBookImage:function(t,e){this.bookCoverImg=e},bookCoverTemplate:_.template('<div class="tbs-book-cover-wrapper"><div class="tbs-book-cover-bg <%= size ? size : "small" %>"><% if (bookCoverImg) { %><img class="tbs-book-cover-img" src="<%= bookCoverImg %>"><% } else { %><div class="tbs-book-cover-text-wrapper"><% if (size === "large" || size === "medium") {%><div class="soln-title">Solutions</div><div class="split"></div><% } %><div class="tbs-book-cover-title"><%= bookCoverTxt %></div></div><% } %></div></div>')});return t}()),Eggshell.define("C.page.playerpages_sdk",{inputs:{render:{payload:null}},outputs:{},strict:!1},function(){var t=Backbone.View.extend({initialize:function(t){this.options=t,this.firstTimeLoading=!0,C.utility.loadScript(this.options.tbsSdkCDN+"js/index.js",this.render.bind(this)),this.wireTutorComponent(),this.doSessionLogging(),this.configureHeaderAutosuggest(),this.doFreeAccessOffer(),this.doUnCancelBanner(),this.options.doRightRail&&($(".chg-content").addClass("right-rail-content"),this.doPostQuestionWidget(),this.doMyTbs()),this.Eggshell.on("destroy",this.destroy),this.checkFixedAnswer()},checkFixedAnswer:function(){var t=this;t.options.showNotificationBanner&&C.logger.doSessionLog({fast_track_notification:1});var e='Hey there! we have updated an answer based on your feedback. <a href="/homework-help/questions-and-answers/q'+t.options.fixedContentId+'" class="check_fixed_answer">Check answer</a>';$(".msg-subheading").append(e),$(".check_fixed_answer").on("click",function(){C.logger.doSessionLog({fast_track_notification_click:1})}),$(".close-btn").on("click",function(){$(".msg-noti-lg").hide()})},doFreeAccessOffer:function(){if(this.options.accessExpireDate){var t=function(t){var t=t.subsPriceData,e="undefined"!=typeof t.monthly?"$"+t.monthly.price+" monthly":"";this.adjustPageForFullWidthBanner($("#free-access-banner")),$("#free-access-banner .price").html(e),$("#free-access-banner button").on("click",$.proxy(function(){C.logger.doSessionLog({freemium_banner_click:"1"}),this.displayCSPriceModal()},this))}.bind(this);if(this.getSubsPriceData(t),C.utility.getParams().freeAccessOffered&&!C.utility.getLocal("freeAccessDialogShown")){C.utility.setLocal("freeAccessDialogShown",1);var e=Eggshell.create("C.common.dialog").trigger("set headline","Welcome to Chegg Study").trigger("set sub headline","( 24-hour free access )").trigger("set id","free-access-dialog").trigger("set content html","You have access to :<ul><li>Millions of homework answers</li><li>Step-by-step solutions for your textbooks</li></ul>").trigger("enable default control").trigger("set primary button","Start studying").trigger("hide icon").trigger("hide close button").trigger("disable screen blocker click").on("primary button clicked",function(t){$("#free-access-dialog").find(".close").trigger("click")},this);C.logger.doSessionLog({freemium_onboarding:1})}}},getSubsPriceData:function(t){$.ajax({url:"/_ajax/hwh/subscription/",type:"GET",data:{token:C.global.csrfToken},context:this,success:t,error:function(t){console.log("Error in getting subscription price data: "+JSON.stringify(t))}})},doUnCancelBanner:function(){this.options.showUnCancelBanner&&(this.adjustPageForFullWidthBanner($("#uncancel-banner")),$("#uncancel-banner .uncancel-button").on("click",$.proxy(function(t){var e=$(t.currentTarget).hasClass("uncancel-link")?"uncancel_link_click":"uncancel_button_click",i=JSON.parse('{"'+e+'":1}');C.logger.doSessionLog(i),this.showRestartModal()},this)))},adjustPageForFullWidthBanner:function(t){$(".global-breadcrumb").addClass("adjust-top");var e=function(){var e=$(t).position().top-$(".chgg-hdr").outerHeight();$(t).css({"margin-top":-1*e+"px"})};$(window).on("resize",e),e()},showRestartModal:function(){this.popupRestart?this.popupRestart.trigger("show"):this.popupRestart=Eggshell.create("C.common.csrestartmodal",{subscription:this.options.latestSubscriptionData}).on("primary_cta_clicked",function(){C.logger.doSessionLog({uncancel_modal_click:1}),$("#uncancel-modal").find("button").prop("disabled","disabled")}).on("restart_success",function(){var t=window.location.origin+window.location.pathname+"?cs_restart=1";C.utility.navigate(t)}).trigger("render")},displayCSPriceModal:function(){"undefined"==typeof this.popUp?this.popUp=Eggshell.create("C.common.cspricemodal").on("loaded",$.proxy(function(){this.popUp.trigger("set type","qna").trigger("show cs price modal")},this)):this.popUp.trigger("show cs price modal"),C.logger.doSessionLog({CS_pricemodal:"qna"})},configureHeaderAutosuggest:function(){C.global.headerAutosuggest&&Eggshell.find(C.global.headerAutosuggest).trigger("render",{ajaxEndpoint:"/_ajax/search/tbsserp",target:$(".chgg-hdr .autosuggest-input-field"),filters:{type:"group",count:5,destination:"tbs"}})},fixHeaderOnScroll:function(){var t=$("#solution-player-sdk"),e=$("#solution-player-sdk .main"),i=$(".TBS_TOC"),o=$(".chgg-hdr").hasClass("type-study"),s=$(".TBS_TOOLBAR"),n=s.offset().top;$(window).on("scroll",function(r){var a=$(window).scrollTop(),l=e.height();a>137&&l+137>a?(t.addClass(o?"fixed-dedicated-hdr":"fixed-header"),e.addClass(o?"adjust-dedicated-main":"adjust-main"),i.css({top:a-n+112+"px"}),s.css({left:-$(this).scrollLeft()+t.offset().left}),$("#related-anchors").css(a>l-137?{position:"absolute",top:l-130}:{position:"fixed",top:"160px"})):(t.removeClass(o?"fixed-dedicated-hdr":"fixed-header"),e.removeClass(o?"adjust-dedicated-main":"adjust-main"),i.removeAttr("style"),s.removeAttr("style"),$("#related-anchors").removeAttr("style"))}),$(window).on("resize",function(){var i=$(window).scrollTop(),o=e.height();i>137&&o+137>i?s.css({left:t.offset().left}):s.removeAttr("style")})},doSessionLogging:function(){C.logger.doSessionLog(this.options.editionPage?{SDK_edition_page:1}:this.options.chapterPage?{SDK_chapter_page:1}:{SDK_problem_page:1})},wireTutorComponent:function(){var t=$('<div class="tbs-sub-tutors"></div>');if(this.options.doRightRail?$("#right-rail").append(t):$(".chg-content").append(t),this.options.useTutorsWidgetOc){var e=this.options.doRightRail?"vertical":"horizontal",i=this.options.doRightRail?"rightrail":"bottom",o=this.options.doRightRail?"3":"5";t.html('<div id="chegg_tutors_list"><oc-component href="'+this.options.tutorsWidgetOcUrl+"?limit="+o+"&actions.new_tab=1&layout.type="+e+"&subject_id="+this.options.instaSubjectId+"&attach.client=CheggStudy&attach.widget_location="+i+'&attach.page_type=TBS"></oc-component></div>'),oc.renderUnloadedComponents(),oc.events.on("tutor_list:click",function(t,e){"PROFILE"==e.type?C.logger.doSessionLog({tutor_clicked:1,tutors_faces_shown:o},null,{logSubscription:1}):"CTA"==e.type&&C.logger.doSessionLog({tutors_button_clicked:1,tutors_faces_shown:o},null,{logSubscription:1})})}else this.renderTutorEggshell(t,"tbs",5)},renderTutorEggshell:function(t,e,i,o){this.tutorComponent=Eggshell.create("C.common.tutors",{el:t}),this.setTutorsOpportunityModalData(),this.tutorComponent.trigger("show tutors",{type:e,variant:o,product:"TBS",subjectId:this.options.subjectIdForTutors,subjectName:this.options.subjectNameforTutors,userHasCsSubscription:1,count:i,campaign:"Chegg_Study-TBS",entityId:this.options.problemId})},setTutorsOpportunityModalData:function(){var t=window.location.origin+window.location.pathname;this.tutorComponent.trigger("set opportunity modal data",{modalContext:"TBS_OPP_FLOW",modalBody:"Hi! I'm working on the following textbook problem and would like some help: "+t})},updateBreadcrumb:function(t,e){if(this.options.chapterPage&&"chapter"===e){var i=$(".global-breadcrumb");return void i.html(i.html().replace(/chapter .+/,"chapter "+t))}if("chapter"===e){var o=$(".global-breadcrumb a").last();o.text("chapter "+t);var s=o.attr("href").replace(/-chapter-[^-]+-/,"-chapter-"+t+"-");o.attr("href",s)}if("problem"===e){var i=$(".global-breadcrumb");i.html(i.html().replace(/problem .+/,"problem "+t))}},getRoutes:function(){var t=this.scrubTitleForRoutes(),e={problem:this.convertProblemPathToRoute()};if(this.options.solutionPage||(e={problem:"/homework-help/"+t+"-"+this.options.editionText+"-edition-chapter-:chapter-problem-:problem-solution-:isbn13",chapter:this.convertChapterPathToRoute()}),this.options.editionPage){var i=window.location.pathname,o=i.slice(0,i.lastIndexOf("-"));e=_.extend(e,{base:o+"-:isbn13"})}return e},convertProblemPathToRoute:function(){var t=window.location.pathname,e=/(.*chapter-)[^-]+(-problem-)[^-]+(-solution-)[^-]+/;return t.replace(e,"$1:chapter$2:problem$3:isbn13")},convertChapterPathToRoute:function(){var t=window.location.pathname,e=/(.*chapter-)[^-]+(-solutions-)[^-]+/;return t.replace(e,"$1:chapter$2:isbn13")},scrubTitleForRoutes:function(){var t=this.options.bookTitleText?this.options.bookTitleText.replace(/[^\w-_.~]/g,"-"):"";return t=t.replace(/-+/g,"-")},doAdobeLogging:function(){digitalData.page.pageName="TBS Solution Page",_satellite.track("pageView")},storeBookmarkedKvp:function(){$.ajax({url:"/_ajax/common/userkvp/set",type:"GET",data:{token:C.global.csrfToken,key:"bookmarkedTBS",value:1},context:this,success:$.proxy(function(t){this.displayBookmarkOnboarding(),this.options.bookmarkedTBS=!0},this),error:function(t){console.log("Error storing user kvp value "+JSON.stringify(t))}})},displayBookmarkOnboarding:function(){var t=$(".nav-item"),e=$(".nav-item.study-item .nav-hover-box"),i=$(".chg-container.center-content, .chg-content");e.css("display","block"),t.css("pointer-events","none"),i.css("position","relative"),$("body").addClass("noscroll");var o=function(){e.css("display","none"),t.css("pointer-events","auto"),$("body").removeClass("noscroll"),i.css("position","static")},s=[{top_padding:15,left_padding:60,handle:$(".nav-item-header.link-textbook-solutions"),img:"site/images/tbs2-overlay-text.png"}];Eggshell.create("C.common.onboardingoverlay",{el:$(".chg-container-content")}).trigger("dismiss_on_click").trigger("set_on_click_callback",o).trigger("set_instruction_points",s).trigger("render")},createBookmarkMenuTooltip:function(){if(!this.bookmarkMenuTooltip){var t=function(){return'<div><ul><li><a class="rate-solution">Rate the solution</a></li><li><a class="view-saved-solns" href="/study/tbs/">View all your saved solutions</a></li></ul></div>'};this.bookmarkMenuTooltip=Eggshell.create("C.common.overlay.tooltip").on("return tooltip content node",$.proxy(function(e,i){i.html(t()),this.doRatingTooltipLogic(),$(".view-saved-solns").on("click",function(t){t.preventDefault(),C.logger.doSessionLog({bookmark_menu_all:"tbs"},function(){C.utility.navigate($(t.target).attr("href"))})})},this)).trigger("add custom css class",{cssClass:"bookmark-menu-tooltip",cssSelector:".tooltip"}).trigger("set target",$(".bookmark-btn")).trigger("get tooltip content node").trigger("position caret center").trigger("set tooltip zindex",1e3).trigger("set tooltip the width",200).trigger("hide tooltip when user click anywhere else").trigger("set tooltip below target").trigger("disable tooltip on hover")}this.doBookmarkMenuTooltipLogic()},doBookmarkMenuTooltipLogic:function(){this.bookmarkMenuTooltip&&this.bookmarkMenuTooltip.trigger($(".bookmark-btn").hasClass("bookmarked")?"enable tooltip on hover":"disable tooltip on hover")},doRatingTooltipLogic:function(){var t=this;$(".rate-solution").on("click",function(e){t.rateTooltip.trigger("set target",$(".thumb.thumb-up")).trigger("set tooltip below target").trigger("disable tooltip on hover");var i=$(".thumb.thumb-up").offset().top-$(this).offset().top+$(this).scrollTop()-50;$("html, body").animate({scrollTop:i},1e3,function(){t.rateTooltip.trigger("show")}),C.logger.doSessionLog({bookmark_menu_feedback:"tbs"})}),$("body").on("hover",".thumb-up",function(){t.rateTooltip.trigger("hide")})},createRatingTooltip:function(){this.rateTooltip=Eggshell.create("C.common.overlay.tooltip").on("return tooltip content node",function(t,e){var i=e;i.html('<span class="rate-answer-tooltip">Rate solution here.</span>')}).trigger("get tooltip content node").trigger("add custom css class",{cssClass:"rate-tooltip",cssSelector:".tooltip"}).trigger("position caret center").trigger("set tooltip zindex",1e3).trigger("set tooltip the width",155).trigger("set animation","grow").trigger("hide tooltip when user click anywhere else")},render:function(){var t=!0,e=this.options.odinConcatUrl?this.options.odinConcatUrl:window.location.origin;TBSPlayer.setRootURL(e);var i=TBSPlayer.getPlayer({target:document.querySelector("#solution-player-sdk"),isbn13:this.options.isbn13,user:this.options.userData,routes:this.getRoutes(),show_comments:this.options.accessExpireDate?!1:!0,show_bookmark:this.options.showBookmark,onProblemOpened:$.proxy(function(t){(this.options.solutionPage||this.options.chapterPage)&&(this.updateBreadcrumb(t.chapter,"chapter"),this.updateBreadcrumb(t.problem,"problem")),C.logger.doSessionLog({isbn_viewed:this.options.isbn13,problem_viewed:t.problem,chapter_viewed:t.chapter}),this.firstTimeLoading||this.doAdobeLogging(),this.firstTimeLoading=!1},this),onProblemLoaded:$.proxy(function(e){if(t)this.options.doOnboardingSequence&&setTimeout($.proxy(function(){this.doOnboardingSequence()},this),1e3),this.createBookmarkMenuTooltip();else{var i=$(".TBS_ROOT .main").offset().top;window.scrollTo(0,i-50),this.doBookmarkMenuTooltipLogic()}var o=e&&e.problemId?e.problemId:null;if(o&&!this.options.useTutorsWidgetOc&&(Eggshell.find(this.tutorComponent).trigger("set entity id",o),this.setTutorsOpportunityModalData()),this.rateTooltip&&this.rateTooltip.trigger("destroy"),this.createRatingTooltip(),this.options.cspEnabled){var s=!(t&&this.options.doOnboardingSequence);this.makeCSPCall(e,s)}this.options.bookmarkCountEnabled&&(this.bookmarkCountTooltip&&this.bookmarkCountTooltip.destroy(),this.doBookmarkCountLogic()),t=!1},this),onLimitExceeded:function(t){$(".fullscreen.contract").trigger("click"),Eggshell.create("C.common.viewlimitmodal")},onNoSolutionCTA:$.proxy(function(){C.utility.navigate(window.location.origin+"/"+this.options.qaPostPage)},this),onNetworkErrorCTA:function(){C.utility.refresh()},onBookmarkClicked:$.proxy(function(t){t.bookmarked?(C.logger.doSessionLog({bookmark_tbs_save:t.id},null,{logSubscription:1}),C.utility.fireAdobeClickEvent({eventName:"bookmark | tbs",eventValue:t.id,eventID:"event60"})):(C.logger.doSessionLog({bookmark_tbs_unsave:t.id},null,{logSubscription:1}),C.utility.fireAdobeClickEvent({eventName:"remove bookmark | tbs",eventValue:t.id,eventID:"event63"})),this.options.bookmarkedTBS?this.options.showBookmarkMenuTooltip&&(t.bookmarked?this.bookmarkMenuTooltip.trigger("enable tooltip on hover").trigger("show"):this.bookmarkMenuTooltip.trigger("disable tooltip on hover").trigger("hide")):(C.logger.doSessionLog({bookmark_tbs_overlay:1}),this.storeBookmarkedKvp()),this.bookmarkCountTooltip&&this.bookmarkCountTooltip.trigger("hide")},this),onReviewClicked:function(t){C.logger.doSessionLog({feedback_click:0==t.reviewValue?"thumbs_up":"thumbs_down"},null,{logSubscription:1})}});this.fixHeaderOnScroll(),this.listenToFullScreenChange()},makeCSPCall:function(t,e){$.ajax({url:"/_ajax/csp/",type:"GET",data:{token:C.global.csrfToken,isbn13:this.options.isbn13,chapter:{name:t.chapter},problem:{id:t.problemId,name:t.problem},options:{hasSubscription:!0,doRightRail:this.options.doRightRail}},context:this,success:function(t){var i,o,s,n=0,r,a,l,c=null;if(!t.error&&t.result){var t=t.result;t["video-walkthrough"]&&(i=1,r=t["video-walkthrough"]),t["video-list"]&&(o=1,a=t["video-list"]),t["csp-relatedexamples"]&&(s=1,l=t["csp-relatedexamples"]),c=t.section?t.section:"",n=t.canShowOnboarding}var d={walkthrough:i,relatedvideos:o,examples:s};this.createCSPAnchors(d),this.replaceCSPContent({walkthrough:r,relatedvideos:a,examples:l,section:c}),e&&n&&this.doCspOnboardingLogic(d)},error:function(t){console.log("Error in getting CSP data: "+JSON.stringify(t))}})},createCSPAnchors:function(t){$("#related-anchors").remove(),$(".fullscreen").off("click"),$(".TBS_ROOT .main").append('<div id="related-anchors" class="'+(this.options.doRightRail?"rr-anchors":"")+'"></div>');var e=$("#related-anchors"),i=0,o=function(t,e){$("html, body").animate({scrollTop:t.offset().top-80},500),C.logger.doSessionLog({csp_tab_click:e})};if(t.walkthrough&&(e.append('<div class="walkthrough-anchor">Walkthrough<br/>for problem</div>'),$(".walkthrough-anchor").on("click",o.bind(this,$(".csp-content"),"walkthrough")),i++),t.relatedvideos){var s=t.walkthrough?"":" video-icn";e.append('<div class="related-video-anchor'+s+'">Related<br/>videos</div>'),$(".related-video-anchor").on("click",o.bind(this,$(".related-videos-wrapper"),"relatedvideos")),i++}t.examples&&(e.append('<div class="related-examples-anchor">Related<br/>examples</div>'),$(".related-examples-anchor").on("click",o.bind(this,$(".related-examples-wrapper"),"examples")),i++),1===i&&e.find("[class*=anchor]").addClass("solo-anchor")},replaceCSPContent:function(t){var e=$(".csp-walkthrough-content").empty(),i=$(".csp-related-videos-content").empty(),o=$(".csp-related-examples-content").empty(),s=$(".related-videos-wrapper"),n=$(".related-examples-wrapper"),r=$(".csp-content-subheader .csp-subject-highlight");t.walkthrough&&t.walkthrough.length&&e.append(t.walkthrough),t.relatedvideos&&t.relatedvideos.length?(s.show(),i.append(t.relatedvideos)):s.hide(),t.examples&&t.examples.length?(n.show(),o.append(t.examples)):n.hide(),t.section&&r.text(t.section),oc.renderUnloadedComponents()},doCspOnboardingLogic:function(t){var e=[];(t.walkthrough&&t.walkthrough>0||t.relatedvideos&&t.relatedvideos>0)&&(e.push(t.walkthrough&&t.walkthrough>0?{handle:$(".walkthrough-anchor"),highlightHandle:$(".walkthrough-anchor"),content:"Watch a video walkthrough of this problem",position:"left"}:{handle:$(".related-video-anchor"),highlightHandle:$(".related-video-anchor"),content:"Watch videos related to this problem",position:"left"}),t.examples&&t.examples>0&&e.push({handle:$(".related-examples-anchor"),highlightHandle:$(".related-examples-anchor"),content:"Explore examples related to concepts in this problem",position:"left"})),e.length&&$.ajax({url:"/_ajax/common/userkvp/set",type:"GET",data:{token:C.global.csrfToken,key:"onboarding_csp",value:1},context:this,success:function(t){this.renderCspOnboarding(e)},error:function(t){console.log("Error setting `onboarding_csp` userkvp "+JSON.stringify(t))}})},renderCspOnboarding:function(t){var e=$(".chg-content"),i=$(".chg-content .global-breadcrumb");$(".chg-container.center-content").css({position:"relative"}),Eggshell.create("C.common.onboardingsequence",{el:$(".chg-container-content")}).trigger("set_banner_handle",i).trigger("set_banner_text","Score! You've discovered extra help for this textbook").trigger("set_banner_button_text","Show me").trigger("disable_step_counter").trigger("set_obfuscation_handle",e).trigger("set_instruction_points",t).on("sequence_started",function(){C.logger.doSessionLog({csp_onboarding_sequence_started:"TBS"})}).on("sequence_completed",function(){C.logger.doSessionLog({csp_onboarding_sequence_completed:"TBS"}),$(".chg-container.center-content").css({position:"static"})}).on("close_button_clicked",function(t,e){C.logger.doSessionLog({csp_onboarding_sequence_close:e.stepNumber})}).on("step_viewed",function(t,e){C.logger.doSessionLog({csp_onboarding_sequence_viewed:e.stepNumber})}).trigger("render")},listenToFullScreenChange:function(){$(document).bind("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){var t=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen,e=$("#related-anchors");t||$(".fullscreen.contract").trigger("click"),e.length&&e.toggle()})},doOnboardingSequence:function(){var t=[{handle:$(".TBS_TOOLBAR .bookmark-tab"),highlightHandle:$(".TBS_TOOLBAR .bookmark-tab"),content:"Save solution for quick access later on",position:"bottom"},{handle:$(".review-box .thumb-up"),highlightHandle:$(".review-box"),content:"Give us feedback on the solution provided",position:"bottom"},{handle:$(".chgg-hdr-search-container .chgg-hdr-search-box"),highlightHandle:$(".chgg-hdr-search-container .chgg-hdr-search-box"),content:"Search archive of millions of homework answers",position:"bottom"}],e=$(".chg-content"),i=$(".chg-content .global-breadcrumb");$(".chg-container.center-content").css({position:"relative"}),Eggshell.create("C.common.onboardingsequence",{el:$(".chg-container-content")}).trigger("set_banner_handle",i).trigger("set_obfuscation_handle",e).trigger("set_instruction_points",t).on("sequence_started",function(){C.logger.doSessionLog({onboarding_sequence_started:"TBS"})}).on("sequence_completed",function(){C.logger.doSessionLog({onboarding_sequence_completed:"TBS"}),$(".chg-container.center-content").css({position:"static"})}).on("close_button_clicked",function(t,e){C.logger.doSessionLog({onboarding_sequence_close:e.stepNumber})}).on("step_viewed",function(t,e){C.logger.doSessionLog({onboarding_sequence_viewed:e.stepNumber})}).trigger("render")},doMyTbs:function(){Eggshell.create("C.common.mytbs",{el:$(".my-tbs")}).trigger("set_source","tbs_page").trigger("render")},doPostQuestionWidget:function(){Eggshell.create("C.common.question.form",{el:$(".post-question")}).trigger("set source","tbs_page").trigger("set form title","Post a question").trigger("set form subtitle","Answers from our experts for your tough homework questions").trigger("set placeholder text","Enter question").trigger("show remaining questions",!0).trigger("render")},doBookmarkCountLogging:function(){setTimeout(function(){var t=$(".bookmark-count");if(t.length){var e=t.text().split(" ")[0].replace(/\W+/,"");C.logger.doSessionLog({bookmark_other_users_text_shown:"TBS",bookmark_other_users_tbs_count:e})}},1e3)},doBookmarkCountLogic:function(){this.doBookmarkCountLogging();var t=this,e=function(e){var i=e&&e.result?e.result.hasAsset:!1,o=$(".bookmark-count");!i&&o.length&&setTimeout(function(){var e=o.text().split(" ")[0].replace(/\W+/,""),i=parseInt(e)>1?"students":"student",s='<div class="bookmark-count-tooltip-msg"><span class="exit-icn"></span><span class="bookmark-icn"></span>'+e+" "+i+" bookmarked this problem. Save it for later.</div>";t.bookmarkCountTooltip=Eggshell.create("C.common.overlay.tooltip"),t.bookmarkCountTooltip.on("return tooltip content node",$.proxy(function(e,i){i.html(s),$(".exit-icn").on("click",function(){C.logger.doSessionLog({bookmark_other_users_popup_closed:"TBS"}),t.bookmarkCountTooltip.trigger("hide").trigger("disable tooltip on hover")})},this)).trigger("add custom css class",{cssClass:"bookmark-count-tooltip",cssSelector:".tooltip"}).trigger("set target",$(".bookmark-tab")).trigger("get tooltip content node").trigger("set tooltip zindex",1).trigger("set tooltip the width",207).trigger("set tooltip below target").trigger("disable tooltip on hover");var n=C.utility.getParams();n.hasOwnProperty("hwh_cr")||t.bookmarkCountTooltip.trigger("show");var r=window.pageYOffset,a=window.pageYOffset+window.innerHeight,l=$(".bookmark-tab").offset().top+20,c=l>r&&a>l&&"hidden"!==$(".bookmark-count-tooltip").css("visibility");C.logger.doSessionLog(c?{bookmark_other_users_popup_shown:"tbs_visible"}:{bookmark_other_users_popup_shown:"tbs_invisible"})},2500)},i={type:"TBS",token:C.global.csrfToken,action_id:"has"};this.getBookmarkInfo(i,e,"POST")},getBookmarkInfo:function(t,e,i){$.ajax({url:"/_ajax/userasset",type:i,data:t,context:this,success:e,error:function(t){console.log("Error in getting bookmark data: "+JSON.stringify(t))}})},destroy:function(){var t=this.options.tbsSdkCDN+"js/index.js";$('script[type="text/javascript"][src~="'+t+'"]').remove()}});return t}());